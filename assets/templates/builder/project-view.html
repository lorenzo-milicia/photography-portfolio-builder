<div class="card">
    <h2>{{.Project.Title}}</h2>

    <form hx-post="/api/project/update" hx-swap="none">
        <input type="hidden" name="slug" value="{{.Project.Slug}}">

        <div class="form-group">
            <label for="title">Project Title</label>
            <input type="text" id="title" name="title" value="{{.Project.Title}}" required>
        </div>

        <div class="form-group">
            <label for="description">Description</label>
            <textarea id="description" name="description">{{.Project.Description}}</textarea>
        </div>

        <div class="form-group" style="display: flex; align-items: center; gap: 0.5rem;">
            <input type="checkbox" id="hidden" name="hidden" style="width: auto;" {{if .Project.Hidden}}checked{{end}}>
            <label for="hidden" style="margin: 0; cursor: pointer;">Hidden / Draft (Do not generate)</label>
        </div>

        <button type="submit" class="btn btn-success">Update Project</button>
        <button type="button" class="btn btn-danger" hx-post="/api/project/delete?slug={{.Project.Slug}}"
            hx-confirm="Are you sure you want to delete this project?" hx-swap="none">
            Delete Project
        </button>
    </form>
</div>

<div class="card">
    <h3>ðŸŽ¨ Layout</h3>
    <p style="color: var(--text-light); margin-bottom: 1.5rem;">
        Arrange your selected photos on a customizable grid layout.
    </p>

    <div style="display: flex; gap: 1rem; align-items: center;">
        <a href="/layout/{{.Project.Slug}}" class="btn btn-primary" style="text-decoration: none;">
            Edit Layout
        </a>
        <span style="color: var(--text-light); font-size: 0.875rem;">
            Grid: {{.Layout.GridWidth}} columns, {{len .Layout.Placements}} photo(s) placed
        </span>
    </div>
</div>

<div class="card">
    <h3>ðŸ“¸ Photos</h3>
    <p style="color: var(--text-light); margin-bottom: 1.5rem;">
        Place photos in <code>content/photos/{{.Project.Slug}}/</code> or upload them here.
    </p>

    <div style="margin-bottom: 2rem;">
        <form hx-post="/api/project/upload" hx-encoding="multipart/form-data" hx-swap="none">
            <input type="hidden" name="slug" value="{{.Project.Slug}}">
            <input type="file" name="upload" accept="image/png, image/jpeg" required
                onchange="this.form.requestSubmit()">
            <small style="display: block; color: var(--text-light); margin-top: 0.5rem;">
                Select an image to upload. It will be processed automatically.
            </small>
        </form>
    </div>

    <div id="photo-gallery">
        {{if .Photos}}
        {{range .Photos}}
        <div class="photo-item" data-hash-id="{{.HashID}}">
            <img src="{{.ThumbPath}}" alt="{{.Filename}}" loading="lazy">
            <div class="photo-info">
                <span class="photo-name">{{.Filename}}</span>
                <span class="photo-size">{{.RatioWidth}}:{{.RatioHeight}}</span>
            </div>
            <button class="btn-delete-photo"
                hx-delete="/api/project/photo?slug={{$.Project.Slug}}&filename={{.Filename}}"
                hx-confirm="Are you sure you want to delete {{.Filename}}?" hx-target="closest .photo-item"
                hx-swap="delete" title="Delete photo">
                Ã—
            </button>
        </div>
        {{end}}
        {{else}}
        <p style="text-align: center; color: var(--text-light); padding: 3rem;">
            No photos found. Add photos to <code>content/photos/{{.Project.Slug}}/</code>
        </p>
        {{end}}
    </div>
</div>